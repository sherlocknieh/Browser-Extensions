<style>
/* 伪类保留在 style 标签中 */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.qr-drop-zone:hover { border-color: #007bff; background: #f0f8ff; }
.qr-drop-zone.dragover { border-color: #007bff; background: #e3f2fd; transform: scale(1.02); }
.qr-drop-zone.has-image { border-style: solid; border-color: #28a745; background: white; cursor: default; }

.qr-image-preview.show { display: block; }
.qr-loading.show { display: block; }

.qr-btn-primary:hover:not(:disabled) { background: #0056b3; transform: translateY(-1px); }
.qr-btn-success:hover:not(:disabled) { background: #1e7e34; transform: translateY(-1px); }
.qr-btn-secondary:hover:not(:disabled) { background: #545b62; transform: translateY(-1px); }
.qr-btn:disabled { opacity: 0.6; cursor: not-allowed; }

.qr-result.success { display: block; background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
.qr-result.error { display: block; background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }

.qr-mini-btn:hover { opacity: 0.8; }
</style>

<div id="qr-paste-dialog-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999999; display: flex; align-items: center; justify-content: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
    <div id="qr-paste-dialog" style="background: white; border-radius: 12px; padding: 24px; max-width: 480px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15); outline: none;">
        <div style="text-align: center; margin-bottom: 24px;">
            <h2 style="margin: 0 0 8px 0; color: #333; font-size: 20px; font-weight: 600;">粘贴图片识别二维码</h2>
            <p style="margin: 0; color: #666; font-size: 14px;">支持粘贴、拖拽或点击选择图片</p>
        </div>

        <div class="qr-drop-zone" id="qr-drop-zone" style="border: 2px dashed #ccc; border-radius: 8px; padding: 32px 16px; text-align: center; cursor: pointer; transition: all 0.3s ease; background: #fafafa; position: relative; margin-bottom: 20px;">
            <svg class="qr-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 48px; height: 48px; margin: 0 auto 16px; opacity: 0.6;">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            
            <div class="qr-upload-text" style="color: #666; font-size: 14px; margin-bottom: 8px;">点击加载本地图片或拖拽图片到此处</div>
            <div class="qr-upload-hint" style="color: #999; font-size: 12px;">Ctrl+V 粘贴剪贴板图片</div>
            
            <img class="qr-image-preview" id="qr-image-preview" alt="预览图片" style="max-width: 100%; max-height: 200px; object-fit: contain; display: none; margin: 16px auto;">
            <input type="file" id="qr-file-input" accept="image/*" style="display: none;">
        </div>

        <div class="qr-loading" id="qr-loading" style="display: none; text-align: center; padding: 20px;">
            <div class="qr-spinner" style="border: 3px solid #f3f3f3; border-top: 3px solid #007bff; border-radius: 50%; width: 32px; height: 32px; animation: spin 1s linear infinite; margin: 0 auto 12px;"></div>
            <div style="font-size: 14px; color: #666;">正在识别...</div>
        </div>

        <div class="qr-result" id="qr-result" style="display: none; padding: 16px; border-radius: 6px; font-size: 13px; word-break: break-all; margin-top: 16px;">
            <div id="qr-result-text"></div>
            <div id="qr-result-buttons" style="display: flex; gap: 8px; margin-top: 12px;"></div>
        </div>

        <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 16px;">
            <button class="qr-btn qr-btn-secondary" id="qr-clear-btn" style="padding: 8px 16px; border: none; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all 0.2s ease; background: #f0f0f0; color: #666;">清除图片</button>
            <button class="qr-btn qr-btn-primary" id="qr-close-btn" style="padding: 8px 24px; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; background: #007bff; color: white;">关闭</button>
        </div>
    </div>
</div>